---
initContainers:
  - name: init-rag-data
    image: sed.edit.RAG_IMAGE
    command:
      - "sh"
      - "-c"
      - "echo 'Copying RAG data...'; cp -r /rag/vector_db/rhdh_product_docs /data/ && cp -r /rag/embeddings_model /data/ && echo 'Copy complete.'"
    volumeMounts:
      - mountPath: /data
        name: rag-data-volume
containers:
  - envFrom:
    - secretRef:
        name: llama-stack-secrets
    image: sed.edit.LLS_IMAGE
    name: llama-stack
    volumeMounts:
      - mountPath: /app-root/.llama
        name: shared-storage
      - mountPath: /app-root/embeddings_model
        name: rag-data-volume
        subPath: embeddings_model
      - mountPath: /app-root/vector_db/rhdh_product_docs
        name: rag-data-volume
        subPath: rhdh_product_docs
    # LLAMA_OVERRIDE_MOUNT_START
      - mountPath: /app-root/run.yaml
        subPath: run.yaml
        name: llama-stack-config
    # LLAMA_OVERRIDE_MOUNT_END
  - image: sed.edit.LCS_IMAGE
    name: lightspeed-core
    volumeMounts:
      - mountPath: /app-root/lightspeed-stack.yaml
        name: lightspeed-stack
        subPath: lightspeed-stack.yaml
      - mountPath: /tmp/data/feedback
        name: shared-storage
      - mountPath: /tmp/data/conversations
        name: shared-storage
      - mountPath: /tmp/data/transcripts
        name: shared-storage
volumes:
  - configMap:
      name: lightspeed-stack
    name: lightspeed-stack
  - emptyDir: {}
    name: shared-storage
  - emptyDir: {}
    name: rag-data-volume
  # LLAMA_OVERRIDE_VOLUME_START
  - configMap:
      name: llama-stack-config
    name: llama-stack-config
  # LLAMA_OVERRIDE_VOLUME_END